import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.swing.JOptionPane;

import java.sql.Statement;

public class Login {
	
	private static Connection Conexion;
	ResultSet resultSet;
	Cliente client;
	
	public Login(){
		
	}
	
	//CREAMOS LA CONEXIÓN CON LA BASE DE DATOS
	public void MySQLConnection(String user, String pass, String db_name) throws Exception {
	    try {
	        Class.forName("com.mysql.jdbc.Driver");
	        Conexion = DriverManager.getConnection("jdbc:mysql://localhost:3306/" + db_name, user, pass);
	       // JOptionPane.showMessageDialog(null, "Se ha iniciado la conexión con el servidor de forma exitosa");
	    } catch (ClassNotFoundException ex) {
	        Logger.getLogger(Login.class.getName()).log(Level.SEVERE, null, ex);
	    } catch (SQLException ex) {
	        Logger.getLogger(Login.class.getName()).log(Level.SEVERE, null, ex);
	    }
	}
	
	//INSERTAMOS VALORES EN LA BASE DE DATOS
	 public void insertData(String table_name, String nombre, String email, String pass) {
        try {
            String Query = "INSERT INTO " + table_name + " (nombre,email,pass) VALUES("
                    + "\"" + nombre + "\", "
            		+ "\"" + email + "\", "
                    + "\"" + pass + "\")";
            Statement st = Conexion.createStatement();
            st.executeUpdate(Query);
            //JOptionPane.showMessageDialog(null, "Datos almacenados de forma exitosa");
        } catch (SQLException ex) {
            //JOptionPane.showMessageDialog(null, "Error en el almacenamiento de datos");
        }
    }
	 
	 //MOSTRAMOS LOS VALORES DE LA BASE DE DATOS
	 public Cliente getValues(String table_name) {
        try {
        	String Query = "SELECT * FROM " + table_name;
        	
			Statement st = Conexion.createStatement();
			resultSet = st.executeQuery(Query);
            
            while (resultSet.next()) {
                client = new Cliente(resultSet.getString("nombre"),resultSet.getString("email"),resultSet.getString("direccion"),resultSet.getString("tarjeta"));
            }
 
        } catch (SQLException ex) {
            JOptionPane.showMessageDialog(null, "Error en la adquisición de datos");
        }
		return client;
    }
	 
	//MÉTODO PARA BORRAR REGSITROS
	 
	 public void deleteRecord(String table_name, String ID) {
        try {
            String Query = "DELETE FROM " + table_name + " WHERE ID = \"" + ID + "\"";
            Statement st = Conexion.createStatement();
            st.executeUpdate(Query);

        } catch (SQLException ex) {
            System.out.println(ex.getMessage());
            //JOptionPane.showMessageDialog(null, "Error borrando el registro especificado");
        }
    }
	 
	 public ArrayList<String> showCountries(String table_name){
		 ArrayList<String> arrayCountries = new ArrayList<String>();
		 try{
			 String Query = "SELECT * FROM " + table_name;
			 Statement st = Conexion.createStatement();
			 resultSet = st.executeQuery(Query);
			 while(resultSet.next()){
				 arrayCountries.add(resultSet.getString("nombre"));
			 }
		 }catch(SQLException ex){
			 //JOptionPane.showMessageDialog(null, "No existen países en la tabla");
		 }
		 return arrayCountries;
	 }
	 
	 public ArrayList<Productos> showProducts(String table_name){
		 
		 ArrayList<Productos> arrayProducts = new ArrayList<Productos>();
		 try{
			 String Query = "SELECT paises.nombre, productos.nombre, productos.id_producto, productos.codigo, productos.stock, productos.precio FROM paises, productos WHERE productos.id_pais = paises.id_pais";
			 Statement st = Conexion.createStatement();
			 resultSet = st.executeQuery(Query);
			 while(resultSet.next()){
				 arrayProducts.add(new Productos(resultSet.getString("productos.nombre"),resultSet.getInt("id_producto"),resultSet.getInt("codigo"),resultSet.getString("paises.nombre"),resultSet.getInt("stock"),resultSet.getFloat("precio")));
			 }
		 }catch(SQLException ex){
			 //JOptionPane.showMessageDialog(null, "No existen productos en la tabla");
		 }
		 return arrayProducts;
	 }
	 
	 public boolean logIn(String table_name, String user, String pass){
		 try{
			 String Query = "SELECT nombre FROM " + table_name + " WHERE nombre = '" + user + "' and pass = " + pass;
			 Statement st = Conexion.createStatement();
			 resultSet = st.executeQuery(Query);
			 boolean resultado = resultSet.next();
			 if(resultado == false){
				 return false;
			 }else{
				 return true;
			 }
		 }catch(SQLException ex){
			 //JOptionPane.showMessageDialog(null, "No hay usuario");
		 }
		return false;
	 }
	
	public static void main(String[] args) throws Exception {
		Login log = new Login();
		log.MySQLConnection("root", "", "comandas");
		log.insertData("clientes", "Jose", "jcalata@xcat.cat", "123456");
	}
	
}

